{"version":3,"sources":["Controls.tsx"],"names":["React","useState","useRef","useEffect","View","StyleSheet","TouchableWithoutFeedback","Text","ActivityIndicator","PlayIcon","PauseIcon","FSIcon","ExitFSIcon","ProgressBar","sec2time","TIME_TO_HIDE_CONTROLS","play","topBar","ready","duration","currentTime","playVideo","pauseVideo","seekTo","toggleFS","fullScreen","showFullScreenButton","visible","setVisible","ref","hideControls","current","clearTimeout","setTimeout","hideAfterExecute","action","progress","styles","container","paddingHorizontal","upperView","controls","backgroundColor","footer","bottom","text","footerRight","create","absoluteFillObject","elevation","alignContent","justifyContent","alignItems","width","flexDirection","position","color","fontSize","marginRight","height"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\r\nimport {\r\n  View,\r\n  StyleSheet,\r\n  TouchableWithoutFeedback,\r\n  Text,\r\n  ActivityIndicator\r\n} from \"react-native\";\r\nimport { PlayIcon, PauseIcon, FSIcon, ExitFSIcon } from \"./icons\";\r\nimport ProgressBar from \"./ProgressBar\";\r\nimport { sec2time } from \"./Utils\";\r\n\r\nconst TIME_TO_HIDE_CONTROLS = 2000;\r\n\r\ntype Props = {\r\n  play: Boolean;\r\n  ready: Boolean;\r\n  showFullScreenButton?: Boolean;\r\n  fullScreen: Boolean;\r\n  duration: number;\r\n  currentTime: number;\r\n  playVideo: () => void;\r\n  pauseVideo: () => void;\r\n  seekTo: (t: number) => void;\r\n  toggleFS: () => void;\r\n  topBar?: ({\r\n    play,\r\n    fullScreen\r\n  }: {\r\n    play?: Boolean;\r\n    fullScreen?: Boolean;\r\n  }) => React.ReactNode;\r\n};\r\n\r\nexport default ({\r\n  play,\r\n  topBar,\r\n  ready,\r\n  duration,\r\n  currentTime,\r\n  playVideo,\r\n  pauseVideo,\r\n  seekTo,\r\n  toggleFS,\r\n  fullScreen,\r\n  showFullScreenButton\r\n}: Props) => {\r\n  const [visible, setVisible] = useState(true);\r\n  const ref: { current: any } = useRef(0);\r\n  const hideControls = () => {\r\n    if (ref.current !== 0) clearTimeout(ref.current);\r\n    if (play && ready) {\r\n      ref.current = setTimeout(() => {\r\n        setVisible(false);\r\n      }, TIME_TO_HIDE_CONTROLS);\r\n    }\r\n  };\r\n  const hideAfterExecute = (action: Function) => {\r\n    hideControls();\r\n    return action;\r\n  };\r\n  useEffect(() => {\r\n    hideControls();\r\n    return () => {\r\n      clearTimeout(ref.current);\r\n    };\r\n  }, [play, ready]);\r\n  const progress =\r\n    currentTime !== 0 && duration !== 0 ? currentTime / duration : 0;\r\n\r\n  return (\r\n    <View\r\n      style={[styles.container, { paddingHorizontal: fullScreen ? 40 : 0 }]}\r\n      pointerEvents=\"auto\"\r\n    >\r\n      <TouchableWithoutFeedback\r\n        onPress={() => hideAfterExecute(setVisible)(true)}\r\n        style={styles.upperView}\r\n      >\r\n        <View style={styles.upperView} />\r\n      </TouchableWithoutFeedback>\r\n\r\n      {visible && (\r\n        <TouchableWithoutFeedback onPress={() => hideAfterExecute(() => {})()}>\r\n          <View\r\n            style={[\r\n              styles.controls,\r\n              {\r\n                paddingHorizontal: fullScreen ? 40 : 5,\r\n                backgroundColor: ready ? \"rgba(0,0,0,0.6)\" : \"#000\"\r\n              }\r\n            ]}\r\n          >\r\n            {topBar && topBar({ play, fullScreen })}\r\n            {!ready && <ActivityIndicator size=\"small\" color=\"#FFF\" />}\r\n            {ready && play && <PauseIcon onPress={pauseVideo} />}\r\n            {ready && !play && <PlayIcon onPress={playVideo} />}\r\n\r\n            <View style={[styles.footer, { bottom: fullScreen ? 30 : 10 }]}>\r\n              <Text style={styles.text}> {sec2time(currentTime)} </Text>\r\n              <View style={styles.footerRight}>\r\n                <Text style={styles.text}> {sec2time(duration)} </Text>\r\n                {showFullScreenButton && (\r\n                  <React.Fragment>\r\n                    {fullScreen ? (\r\n                      <ExitFSIcon size={16} onPress={toggleFS} />\r\n                    ) : (\r\n                      <FSIcon size={16} onPress={toggleFS} />\r\n                    )}\r\n                  </React.Fragment>\r\n                )}\r\n              </View>\r\n            </View>\r\n          </View>\r\n        </TouchableWithoutFeedback>\r\n      )}\r\n      <ProgressBar\r\n        value={progress}\r\n        {...{ fullScreen, visible, seekTo, duration, pauseVideo, playVideo }}\r\n      />\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    ...StyleSheet.absoluteFillObject,\r\n\r\n    elevation: 999\r\n  },\r\n  upperView: {\r\n    ...StyleSheet.absoluteFillObject,\r\n    elevation: 11\r\n  },\r\n  controls: {\r\n    ...StyleSheet.absoluteFillObject,\r\n    alignContent: \"center\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    backgroundColor: \"rgba(0,0,0,0.6)\"\r\n  },\r\n  footer: {\r\n    width: \"100%\",\r\n    flexDirection: \"row\",\r\n    justifyContent: \"space-between\",\r\n    alignItems: \"center\",\r\n    position: \"absolute\"\r\n  },\r\n  text: {\r\n    color: \"#FFF\",\r\n    fontSize: 12,\r\n    marginRight: 0\r\n  },\r\n  footerRight: {\r\n    flexDirection: \"row\",\r\n    alignItems: \"center\"\r\n  },\r\n  progress: {\r\n    width: \"100%\",\r\n    height: 2,\r\n    position: \"absolute\",\r\n    bottom: 0,\r\n    backgroundColor: \"red\"\r\n  }\r\n});\r\n"]}